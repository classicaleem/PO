@model PurchaseOrder
@{
    ViewData["Title"] = "Print PO - " + Model.InternalPoCode;
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body { font-family: 'Segoe UI', sans-serif; font-size: 14px; }
        .company-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; }
        .company-name { font-size: 1.5rem; font-weight: bold; }
        .po-title { font-size: 1.8rem; font-weight: bold; background: #f8f9fa; padding: 10px 20px; border-bottom: 3px solid #667eea; }
        .section-title { font-weight: bold; color: #667eea; border-bottom: 2px solid #667eea; padding-bottom: 5px; margin-bottom: 15px; }
        .items-table th { background: #667eea; color: white; }
        .total-row { font-size: 1.2rem; font-weight: bold; }
        @@media print {
            .no-print { display: none !important; }
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>
    <!-- Print Button -->
    <div class="container mt-3 no-print">
        <button onclick="window.print()" class="btn btn-primary me-2"><i class="fas fa-print me-2"></i>Print</button>
        <a href="@Url.Action("Details", new { id = Model.PoId })" class="btn btn-secondary">Back to Details</a>
    </div>

    <div class="container my-4">
        <!-- Company Header -->
        <div class="company-header rounded-top">
            <div class="row">
                <div class="col-8">
                    <div class="company-name">SIM Auto Parts Pvt. Ltd.</div>
                    <div>123 Industrial Estate, Anna Salai</div>
                    <div>Chennai, Tamil Nadu - 600001</div>
                    <div>GST: 33AABCS1234E1Z5 | Phone: +91-44-2852-0000</div>
                </div>
                <div class="col-4 text-end">
                    <div class="po-title bg-white text-dark rounded">PURCHASE ORDER</div>
                </div>
            </div>
        </div>

        <!-- PO Info -->
        <div class="row border border-top-0 p-3">
            <div class="col-6">
                <table class="table table-sm table-borderless mb-0">
                    <tr><td class="text-muted" width="120">PO Code:</td><td class="fw-bold">@Model.InternalPoCode</td></tr>
                    <tr><td class="text-muted">PO Number:</td><td>@Model.PoNumber</td></tr>
                    <tr><td class="text-muted">PO Date:</td><td>@(Model.PoDate?.ToString("dd MMM yyyy") ?? "N/A")</td></tr>
                </table>
            </div>
            <div class="col-6">
                <table class="table table-sm table-borderless mb-0">
                    <tr><td class="text-muted" width="120">Start Date:</td><td>@(Model.StartDate?.ToString("dd MMM yyyy") ?? "N/A")</td></tr>
                    <tr><td class="text-muted">End Date:</td><td>@(Model.EndDate?.ToString("dd MMM yyyy") ?? "N/A")</td></tr>
                    <tr><td class="text-muted">Status:</td><td><span class="badge @(Model.IsCompleted ? "bg-success" : "bg-warning text-dark")">@(Model.IsCompleted ? "Completed" : "Pending")</span></td></tr>
                </table>
            </div>
        </div>

        <!-- Customer Info -->
        @if (Model.Customer != null)
        {
            <div class="border border-top-0 p-3">
                <div class="section-title">Bill To</div>
                <div class="fw-bold">@Model.Customer.CustomerName</div>
                <div>@Model.Customer.FullAddress</div>
                @if (!string.IsNullOrEmpty(Model.Customer.GstNumber))
                {
                    <div><strong>GST:</strong> @Model.Customer.GstNumber</div>
                }
                @if (!string.IsNullOrEmpty(Model.Customer.ContactNumber))
                {
                    <div><strong>Phone:</strong> @Model.Customer.ContactNumber</div>
                }
            </div>
        }

        <!-- Items Table -->
        <div class="border border-top-0 p-3">
            <div class="section-title">Order Items</div>
            <table class="table table-bordered items-table mb-0">
                <thead>
                    <tr>
                        <th style="width: 5%;">#</th>
                        <th style="width: 50%;">Description</th>
                        <th style="width: 15%;" class="text-end">Qty</th>
                        <th style="width: 15%;" class="text-end">Unit Price</th>
                        <th style="width: 15%;" class="text-end">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Items.OrderBy(i => i.LineNumber))
                    {
                        <tr>
                            <td class="text-center">@item.LineNumber</td>
                            <td>@item.ItemDescription</td>
                            <td class="text-end">@item.Quantity</td>
                            <td class="text-end">₹@item.UnitPrice.ToString("N2")</td>
                            <td class="text-end">₹@item.LineTotal.ToString("N2")</td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="4" class="text-end">Total Amount:</td>
                        <td class="text-end">₹@Model.PoAmount.ToString("N2")</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Footer -->
        <div class="border border-top-0 p-3">
            <div class="row mt-4">
                <div class="col-6">
                    <p class="text-muted small">Terms & Conditions apply.</p>
                </div>
                <div class="col-6 text-end">
                    <div class="mt-4 pt-4 border-top" style="width: 200px; margin-left: auto;">
                        <p class="mb-0 text-muted">Authorized Signature</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</body>
</html>
